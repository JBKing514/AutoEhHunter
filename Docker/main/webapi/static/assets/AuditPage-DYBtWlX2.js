import{$ as n,a0 as b,a1 as d,b4 as g,be as k,o as y,a as F,D as t,b8 as s,ay as r,B as i,as as o,ax as V,av as u,ad as m,ar as f,a2 as p,G as h,a6 as v,a9 as C}from"./index-DWWWBiwt.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as T}from"./VTable-EPmq-nns.js";import{V as U}from"./VPagination-BuP6o72G.js";import{V as w}from"./VSwitch-F0PbMuzg.js";const A={setup(){const l=k();return y(()=>{l.loadAudit().catch(()=>null),l.startLogTailPolling()}),F(()=>{l.stopLogTailPolling()}),l}},P={class:"text-subtitle-1 font-weight-medium mb-3"},B={class:"text-subtitle-1 font-weight-medium mb-3"},S=["onClick"],$={class:"d-flex align-center justify-space-between mb-3"},H={class:"text-subtitle-1 font-weight-medium"},N={class:"d-flex ga-2 align-center"},M={class:"text-caption text-medium-emphasis mb-2"},R=["innerHTML"];function D(l,a,z,j,E,G){return n(),b(g,null,{default:d(()=>[t(s,{cols:"12",md:"5"},{default:d(()=>[t(r,{class:"pa-4 mb-3"},{default:d(()=>[i("div",P,o(l.t("audit.filters")),1),t(g,null,{default:d(()=>[t(s,{cols:"12",md:"6"},{default:d(()=>[t(V,{modelValue:l.auditFilter.task,"onUpdate:modelValue":a[0]||(a[0]=e=>l.auditFilter.task=e),items:l.taskOptions,label:l.t("audit.filter.task"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(s,{cols:"12",md:"6"},{default:d(()=>[t(V,{modelValue:l.auditFilter.status,"onUpdate:modelValue":a[1]||(a[1]=e=>l.auditFilter.status=e),label:l.t("audit.filter.status"),items:["","success","failed","timeout"]},null,8,["modelValue","label"])]),_:1}),t(s,{cols:"12"},{default:d(()=>[t(u,{modelValue:l.auditFilter.keyword,"onUpdate:modelValue":a[2]||(a[2]=e=>l.auditFilter.keyword=e),label:l.t("audit.filter.keyword")},null,8,["modelValue","label"])]),_:1}),t(s,{cols:"12",md:"6"},{default:d(()=>[t(u,{modelValue:l.auditFilter.start_date,"onUpdate:modelValue":a[3]||(a[3]=e=>l.auditFilter.start_date=e),type:"date",label:l.t("audit.filter.start_date")},null,8,["modelValue","label"])]),_:1}),t(s,{cols:"12",md:"6"},{default:d(()=>[t(u,{modelValue:l.auditFilter.end_date,"onUpdate:modelValue":a[4]||(a[4]=e=>l.auditFilter.end_date=e),type:"date",label:l.t("audit.filter.end_date")},null,8,["modelValue","label"])]),_:1}),t(s,{cols:"12",md:"6"},{default:d(()=>[t(u,{modelValue:l.auditFilter.limit,"onUpdate:modelValue":a[5]||(a[5]=e=>l.auditFilter.limit=e),modelModifiers:{number:!0},type:"number",min:"5",max:"500",label:"Limit"},null,8,["modelValue"])]),_:1}),t(s,{cols:"12",md:"6",class:"d-flex align-center ga-2"},{default:d(()=>[t(m,{color:"primary",onClick:l.applyAuditFilter},{default:d(()=>[f(o(l.t("audit.filter.apply")),1)]),_:1},8,["onClick"]),t(m,{variant:"text",onClick:l.resetAuditFilter},{default:d(()=>[f(o(l.t("audit.filter.reset")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),t(r,{class:"pa-4"},{default:d(()=>[i("div",B,o(l.t("audit.history")),1),t(T,{density:"compact"},{default:d(()=>[a[9]||(a[9]=i("thead",null,[i("tr",null,[i("th",null,"Time"),i("th",null,"Task"),i("th",null,"Status"),i("th",null,"RC")])],-1)),i("tbody",null,[(n(!0),p(h,null,v(l.auditRows,e=>(n(),p("tr",{key:e.task_id+e.ts,class:C(["audit-row",{selected:l.selectedLog===l.logNameFromPath(e.log_file)}]),onClick:O=>l.selectAuditRow(e)},[i("td",null,o(l.formatDateTime(e.ts)),1),i("td",null,o(e.task),1),i("td",null,o(e.status),1),i("td",null,o(e.rc),1)],10,S))),128))])]),_:1}),t(U,{modelValue:l.auditPage,"onUpdate:modelValue":a[6]||(a[6]=e=>l.auditPage=e),length:l.auditPages,"total-visible":7,class:"mt-3"},null,8,["modelValue","length"])]),_:1})]),_:1}),t(s,{cols:"12",md:"7"},{default:d(()=>[t(r,{class:"pa-4"},{default:d(()=>[i("div",$,[i("div",H,o(l.t("audit.logs")),1),i("div",N,[t(m,{size:"small",color:"warning",variant:"outlined",onClick:l.clearAuditLogsNow},{default:d(()=>[f(o(l.t("audit.log.clear")),1)]),_:1},8,["onClick"]),t(w,{modelValue:l.logAutoStream,"onUpdate:modelValue":a[7]||(a[7]=e=>l.logAutoStream=e),color:"primary","hide-details":"",label:l.t("audit.log.live")},null,8,["modelValue","label"])])]),i("div",M,o(l.selectedLog||"-"),1),t(u,{modelValue:l.logHighlight,"onUpdate:modelValue":a[8]||(a[8]=e=>l.logHighlight=e),class:"mt-2",label:l.t("audit.log.highlight")},null,8,["modelValue","label"]),i("div",{class:"log-view mono mt-2",innerHTML:l.highlightedLogHtml},null,8,R)]),_:1})]),_:1})]),_:1})}const W=L(A,[["render",D]]);export{W as default};
