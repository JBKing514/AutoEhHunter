import{$ as u,a2 as r,D as a,a1 as t,ay as f,G as y,bf as U,o as h,a as M,B as o,as as i,b4 as x,b8 as s,ax as V,a0 as p,av as n,a3 as w,ar as b,ad as k,aw as X,a6 as C,au as E,b3 as B}from"./index-DWWWBiwt.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as T}from"./VSwitch-F0PbMuzg.js";import{V as $}from"./VPagination-BuP6o72G.js";import{V as N}from"./VTable-EPmq-nns.js";const S={setup(){const e=U();return h(()=>{e.loadXp().catch(()=>null)}),M(()=>{e.clearXpTimer()}),e}},z={class:"text-subtitle-1 font-weight-medium mb-3"},K={class:"d-flex ga-2 align-center mb-2"},P={class:"d-flex flex-wrap ga-2"},j={class:"text-subtitle-1 font-weight-medium mb-3"},A={ref:"xpChartEl",style:{width:"100%",height:"520px"}},D={class:"text-subtitle-1 font-weight-medium mb-3"},F={key:0,class:"d-flex align-center ga-4 mb-2"},G={key:1,class:"dendro-wrap"},L={ref:"dendroChartEl",style:{width:"100%",height:"800px"}};function q(e,d,H,I,J,O){return u(),r(y,null,[a(f,{class:"pa-4 mb-4"},{default:t(()=>[o("div",z,i(e.t("xp.title")),1),a(x,null,{default:t(()=>[a(s,{cols:"12",md:"2"},{default:t(()=>[a(V,{modelValue:e.xp.mode,"onUpdate:modelValue":d[0]||(d[0]=l=>e.xp.mode=l),items:[{title:e.t("xp.mode.read_history"),value:"read_history"},{title:e.t("xp.mode.inventory"),value:"inventory"}],"item-title":"title","item-value":"value",label:e.t("xp.mode")},null,8,["modelValue","items","label"])]),_:1}),a(s,{cols:"12",md:"2"},{default:t(()=>[a(V,{modelValue:e.xp.time_basis,"onUpdate:modelValue":d[1]||(d[1]=l=>e.xp.time_basis=l),disabled:e.xp.mode==="read_history",items:[{title:e.t("xp.time_basis.read_time"),value:"read_time"},{title:e.t("xp.time_basis.eh_posted"),value:"eh_posted"},{title:e.t("xp.time_basis.date_added"),value:"date_added"}],"item-title":"title","item-value":"value",label:e.t("xp.time_basis")},null,8,["modelValue","disabled","items","label"])]),_:1}),a(s,{cols:"12",md:"2"},{default:t(()=>[a(V,{modelValue:e.xpTimeMode,"onUpdate:modelValue":d[2]||(d[2]=l=>e.xpTimeMode=l),items:[{title:e.t("xp.time.mode.window"),value:"window"},{title:e.t("xp.time.mode.range"),value:"range"}],"item-title":"title","item-value":"value",label:e.t("xp.time.mode")},null,8,["modelValue","items","label"])]),_:1}),e.xpTimeMode==="window"?(u(),p(s,{key:0,cols:"12",md:"2"},{default:t(()=>[a(n,{modelValue:e.xp.days,"onUpdate:modelValue":d[3]||(d[3]=l=>e.xp.days=l),modelModifiers:{number:!0},type:"number",label:e.t("xp.days")},null,8,["modelValue","label"])]),_:1})):(u(),p(s,{key:1,cols:"12",md:"2"},{default:t(()=>[a(n,{modelValue:e.xp.start_date,"onUpdate:modelValue":d[4]||(d[4]=l=>e.xp.start_date=l),type:"date",label:e.t("xp.filter.start_date")},null,8,["modelValue","label"])]),_:1})),e.xpTimeMode==="range"?(u(),p(s,{key:2,cols:"12",md:"2"},{default:t(()=>[a(n,{modelValue:e.xp.end_date,"onUpdate:modelValue":d[5]||(d[5]=l=>e.xp.end_date=l),type:"date",label:e.t("xp.filter.end_date")},null,8,["modelValue","label"])]),_:1})):w("",!0),a(s,{cols:"12",md:"2"},{default:t(()=>[a(n,{modelValue:e.xp.max_points,"onUpdate:modelValue":d[6]||(d[6]=l=>e.xp.max_points=l),modelModifiers:{number:!0},type:"number",label:e.t("xp.max_points")},null,8,["modelValue","label"])]),_:1}),a(s,{cols:"12",md:"2"},{default:t(()=>[a(n,{modelValue:e.xp.k,"onUpdate:modelValue":d[7]||(d[7]=l=>e.xp.k=l),modelModifiers:{number:!0},type:"number",label:e.t("xp.k")},null,8,["modelValue","label"])]),_:1}),a(s,{cols:"12",md:"2",class:"d-flex align-center text-medium-emphasis"},{default:t(()=>[b(i(e.t("xp.auto_refresh")),1)]),_:1})]),_:1}),a(x,null,{default:t(()=>[a(s,{cols:"12",md:"3"},{default:t(()=>[a(T,{modelValue:e.xp.exclude_language_tags,"onUpdate:modelValue":d[8]||(d[8]=l=>e.xp.exclude_language_tags=l),label:e.t("xp.exclude.language"),"hide-details":""},null,8,["modelValue","label"])]),_:1}),a(s,{cols:"12",md:"3"},{default:t(()=>[a(T,{modelValue:e.xp.exclude_other_tags,"onUpdate:modelValue":d[9]||(d[9]=l=>e.xp.exclude_other_tags=l),label:e.t("xp.exclude.other"),"hide-details":""},null,8,["modelValue","label"])]),_:1}),a(s,{cols:"12",md:"3"},{default:t(()=>[a(n,{modelValue:e.xp.topn,"onUpdate:modelValue":d[10]||(d[10]=l=>e.xp.topn=l),modelModifiers:{number:!0},type:"number",label:e.t("xp.cluster_topn")},null,8,["modelValue","label"])]),_:1}),a(s,{cols:"12",md:"3",class:"d-flex align-center justify-end"},{default:t(()=>[a(k,{variant:"tonal",onClick:e.resetXpConfig},{default:t(()=>[b(i(e.t("audit.filter.reset")),1)]),_:1},8,["onClick"])]),_:1})]),_:1}),o("div",K,[a(n,{modelValue:e.newXpExcludeTag,"onUpdate:modelValue":d[11]||(d[11]=l=>e.newXpExcludeTag=l),label:e.t("xp.filter.exclude_tags"),onKeyup:X(e.addXpExcludeTag,["enter"])},null,8,["modelValue","label","onKeyup"]),a(k,{color:"primary",onClick:e.addXpExcludeTag},{default:t(()=>[...d[14]||(d[14]=[b("Add",-1)])]),_:1},8,["onClick"])]),o("div",P,[(u(!0),r(y,null,C(e.xpExcludeTags,l=>(u(),p(E,{key:l,closable:"","onClick:close":g=>e.removeXpExcludeTag(l)},{default:t(()=>[b(i(l),1)]),_:2},1032,["onClick:close"]))),128))])]),_:1}),a(f,{class:"pa-4 mb-4"},{default:t(()=>[o("div",j,i(e.t("xp.chart_title")),1),o("div",A,null,512)]),_:1}),a(f,{class:"pa-4 mb-4"},{default:t(()=>{var l,g,v;return[o("div",D,i(e.t("xp.dendrogram.title")),1),(l=e.xpResult.dendrogram)!=null&&l.available?(u(),r("div",F,[a($,{modelValue:e.xp.dendro_page,"onUpdate:modelValue":d[12]||(d[12]=m=>e.xp.dendro_page=m),length:((g=e.xpResult.dendrogram)==null?void 0:g.pages)||1,"total-visible":6},null,8,["modelValue","length"]),a(V,{modelValue:e.xp.dendro_page_size,"onUpdate:modelValue":d[13]||(d[13]=m=>e.xp.dendro_page_size=m),modelModifiers:{number:!0},items:[40,60,80,100,150,200],label:"Page size",style:{"max-width":"160px"}},null,8,["modelValue"])])):w("",!0),(v=e.xpResult.dendrogram)!=null&&v.available?(u(),r("div",G,[o("div",L,null,512)])):(u(),p(B,{key:2,type:"info"},{default:t(()=>{var m;return[b(i(((m=e.xpResult.dendrogram)==null?void 0:m.reason)||e.t("xp.dendrogram.too_few")),1)]}),_:1}))]}),_:1}),a(f,{class:"pa-4"},{default:t(()=>[a(N,{density:"compact"},{default:t(()=>[d[15]||(d[15]=o("thead",null,[o("tr",null,[o("th",null,"Cluster"),o("th",null,"Count"),o("th",null,"Top terms")])],-1)),o("tbody",null,[(u(!0),r(y,null,C(e.xpResult.clusters||[],l=>(u(),r("tr",{key:l.cluster_id},[o("td",null,i(l.name),1),o("td",null,i(l.count),1),o("td",null,i((l.top_terms||[]).join(", ")),1)]))),128))])]),_:1})]),_:1})],64)}const c=R(S,[["render",q]]);export{c as default};
