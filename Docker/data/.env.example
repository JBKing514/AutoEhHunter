# =========================
# Data container shared env
# =========================

# -------- Postgres --------
POSTGRES_DSN=postgresql://postgres:change_me@pgvector-db:5432/lrr_library

# -------- First-start DB schema bootstrap --------
DB_INIT_ON_START=1
DB_INIT_FAIL_HARD=0
DB_INIT_MARKER=/app/runtime/.db_schema_initialized
DB_INIT_LOG=/app/runtime/logs/db_init.log
DB_INIT_SCHEMA=/app/textIngest/schema.sql
DB_INIT_CONNECT_TIMEOUT=15

# -------- Data UI --------
DATA_UI_PORT=8501
DATA_UI_RUNTIME_DIR=/app/runtime/webui
COMPUTE_HEALTH_URL=http://autoeh-compute:18080/health
COMPUTE_CONTAINER_NAME=autoeh-compute
# Optional OpenAI-compatible health endpoint, e.g. /v1/models
OPENAI_HEALTH_URL=

# -------- LANraragi --------
LRR_HOST=lanraragi
LRR_PORT=3000
LRR_SCHEME=http
LRR_BASE_PATH=
LRR_API_KEY=

# -------- LRR export (shared defaults) --------
LRR_EXPORT_TIMEOUT=30
LRR_EXPORT_SLEEP=0
LRR_EXPORT_FILTER=
LRR_EXPORT_INCLUDE_RAW_TAGS=0

# -------- LRR metadata export --------
LRR_METADATA_OUT=/app/runtime/exports/lrr_metadata.jsonl
LRR_METADATA_FILTER=
LRR_METADATA_TIMEOUT=30
LRR_METADATA_SLEEP=0
LRR_METADATA_INCLUDE_RAW_TAGS=0

# -------- LRR reads export --------
LRR_READS_OUT=/app/runtime/exports/lrr_reads_last24h.jsonl
LRR_READS_HOURS=24
LRR_READS_FILTER=
LRR_READS_TIMEOUT=30
LRR_READS_SLEEP=0
LRR_READS_INCLUDE_RAW_TAGS=0
LRR_READS_INCLUDE_TANKS=1

# -------- Text ingest --------
# Preferred input form: comma-separated paths
TEXT_INGEST_INPUT=/app/runtime/exports/lrr_metadata.jsonl,/app/runtime/exports/lrr_reads_last24h.jsonl
TEXT_INGEST_SCHEMA=/app/textIngest/schema.sql
TEXT_INGEST_INIT_SCHEMA=0
TEXT_INGEST_BATCH_SIZE=1000
TEXT_INGEST_SOURCE_MODE=basename
TEXT_INGEST_INCLUDE_LASTREAD_AS_EVENT=0
TEXT_INGEST_DRY_RUN=0
TEXT_INGEST_PRUNE_NOT_SEEN=1
TEXT_INGEST_MIN_FULL_BYTES=512000

# Backward-compatible aliases used by run_daily_text_ingest.sh
DATABASE_SCHEMA=/app/textIngest/schema.sql
DATABASE_INIT_FLAGS=0
READS_JSONL=/app/runtime/exports/lrr_reads_last24h.jsonl
FULL_JSONL=/app/runtime/exports/lrr_metadata.jsonl

# -------- EH queue fetch --------
EH_BASE_URL=https://e-hentai.org
EH_FETCH_START_PAGE=0
EH_FETCH_MAX_PAGES=8
EH_FETCH_TIMEOUT=30
EH_REQUEST_SLEEP=4
EH_SAMPLING_DENSITY=1
EH_FETCH_MAX_RUN_MINUTES=0
EH_USER_AGENT=AutoEhHunter/1.0
EH_COOKIE=
EH_STATE_FILE=/app/runtime/eh_ingest_cache/eh_incremental_state.json
EH_QUEUE_FILE=/app/runtime/eh_ingest_cache/eh_gallery_queue.txt
EH_RESET_STATE=0
